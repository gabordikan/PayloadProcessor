var eventData = bindObject('event_data');
var requestData = bindObject('REQUEST_DATA');
var attachmentPdf = getAttachmentDataByAttachmentMnemonicAndBodySite('event_pdf', requestData.bodySiteSnomed);
var eventID = requestData.eventId;


eventData.$$_XID_Map_$$.forEach(function(data) {
    if (data.$$_XID_$$ == '$$_event[1]_$$') {
        requestData.eventId = data.id;
    }
});
var attachmentId = attachmentPdf.getId();
if (requestData.attachmentDataItemToDelete == attachmentId) {
    requestData.attachmentDataItemToDelete = null;
} else {
    linkAttachmentDataWithEvent(attachmentPdf, requestData.eventId, 'OEModule\\OphGeneric\\models\\Attachment');
}
createAndSetThumbnailsOnAttachmentData(attachmentPdf);
deleteRequestBlobData();
addRoutine('delink_attachment');