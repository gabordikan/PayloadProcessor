var eventData = bindObject('event_data');
var requestData = bindObject('REQUEST_DATA');
var octImage = getAttachmentDataByAttachmentMnemonicAndBodySite('event_pdf', requestData.bodySiteSnomed);
var eventID;


eventData.$$_XID_Map_$$.forEach(function(data) {
    if (data.$$_XID_$$ == '$$_event[1]_$$') {
        eventID = data.id;
    }
});
var attachmentId = octImage.getId();
if (requestData.attachmentDataItemToDelete == attachmentId) {
    requestData.attachmentDataItemToDelete = null;
} else {
   linkAttachmentDataWithEventNewGroup(octImage, eventID, 'OEModule\\OphGeneric\\models\\Attachment');
}
createAndSetThumbnailsOnAttachmentData(octImage);
deleteRequestBlobData();
addRoutine('delink_attachment');